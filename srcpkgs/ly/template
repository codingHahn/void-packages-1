# Template file for 'ly'
pkgname=ly
version=0.5.0
revision=1
_argoat_git=36c41f09ecc2a10c9acf35e4194e08b6fa10cf45
_testoasterror_git=71620b47872b5535f87c908883576d73153a6911
_configator_git=c3e1ef175418ccb5b0981ae64ec6f5ae4a60fbaf
_ctypes_git=5dd979d3644ab0c85ca14e72b61e6d3d238d432b
_dragonfail_git=6b40d1f8b7f6dda9746e688666af623dfbcceb94
_termbox_git=d3568927865c15d033d4096cb446d5a3628e2398
build_style=gnu-makefile
hostmakedepends="git"
makedepends="ncurses-devel pam-devel xcb-util-devel libX11-devel"
depends="util-linux xauth"
short_desc="TUI (ncurses-like) display manager"
maintainer="Nick Hahn <nick.hahn@posteo.de>"
license="WTFPL"
homepage="https://github.com/cylgom/ly"
conf_files="/etc/ly/config.ini"
distfiles="
 https://github.com/cylgom/${pkgname}/archive/v${version}.tar.gz
 https://github.com/cylgom/argoat/archive/${_argoat_git}.tar.gz>argoat-${_argoat_git}.tar.gz
 https://github.com/cylgom/testoasterror/archive/${_testoasterror_git}.tar.gz>testoasterror-${_testoasterror_git}.tar.gz
 https://github.com/cylgom/configator/archive/${_configator_git}.tar.gz>configator-${_configator_git}.tar.gz
 https://raw.githubusercontent.com/cylgom/ctypes/${_ctypes_git}/ctypes.h>ctypes-${_ctypes_git}.h
 https://github.com/cylgom/dragonfail/archive/${_dragonfail_git}.tar.gz>dragonfail-${_dragonfail_git}.tar.gz
 https://github.com/cylgom/termbox_next/archive/${_termbox_git}.tar.gz>termbox_next-${_termbox_git}.tar.gz
"
checksum="5311d77a1f9e5e827adc26e7bdf4a6dadb5ada0fa7d85b451b35231cb6d84b6d
 5c284cae748b1cec4eef311845f53ad673f91996ec425c6e323f0c40e829e77f
 bffa1100ffbb7d541a16a9a543e216748fe6f6264fd2b9137738cebcf68d3e8c
 aa92b5d680208eeb4185aa31b1434bc3f13ee11f003e4ab92551ba69ebb641d3
 ef169974c68b548dc8ac83bd4714622775b024fab07dc2b7fe96e8e8f102dbab
 c185f739e392313c08b0d5fd27e93891b89c36b7b49b83570b601b9cbfbddae1
 17a78e28e5ec8d7ee4ec5080c764825b9a79ea780f0d9b5dfa1e4df872ad0112"
patch_args="-Np1"
skip_extraction="ctypes-${_ctypes_git}.h"

pre_configure() {
	cp -rv ../argoat-${_argoat_git}/* sub/argoat/
	cp -rv ../testoasterror-${_testoasterror_git}/* sub/argoat/sub/testoasterror/
	cp -rv ../configator-${_configator_git}/* sub/configator/
	cp -rv $XBPS_SRCDISTDIR/$pkgname-$version/ctypes-${_ctypes_git}.h sub/ctypes/ctypes.h
	cp -rv ../dragonfail-${_dragonfail_git}/* sub/dragonfail/
	cp -rv ../termbox_next-${_termbox_git}/* sub/termbox_next/
}

pre_build() {
	cd sub/argoat/sub/testoasterror
	make
	cd ../../
	make
}

post_install() {
	vsv ly
}
